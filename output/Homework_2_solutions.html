<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Homework_2_solutions</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type="text/css">
  
  /*
   * Copyright 2019 Colin Grudzien <cgrudzien@unr.edu>
   *
   * Based on CSS developed orignally by 
   *
   * Christophe-Marie Duquesne <chmd@chmd.fr>
   *
   * CSS for making functional teaching documents with accessible mathematics
   * with Markdown/ pandoc. Inspired by moderncv.
   * 
   * This CSS document is delivered to you under the CC BY-SA 3.0 License.
   * https://creativecommons.org/licenses/by-sa/3.0/deed.en_US
   */
  
  /* Whole document - standard notebook size and margins */
  body {
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      max-width: 8.5in;
      margin: auto;
      background: #FFFFFF;
      padding: 1in 1in 1in 1in;
  }
  
  /* Title of the document */
  h1 {
      font-size: 50px;
      color: #000000;
      text-align:center;
      margin-bottom:15px;
  }
  
  h1+p {
      /*subtitle*/
      color: #000000;
      font-size: 20px;
      line-height: 2em;
      margin-top: 0.5em;
      margin-bottom: 0em !important;
      text-align: center;
      font-weight: bold;
  }
  
  /* Subheadings */
  h2 {
      color: #000000;
  }
  
  /* Definitions */
  dt {
      float: left;
      clear: left;
      width: 17%;
      /*font-weight: bold;*/
  }
  dd {
      margin-left: 17%;
  }
  p {
      margin-top:0;
      margin-bottom:7px;
  }
  
  /* Blockquotes */
  blockquote {
      text-align: left; 
  }
  
  /* Links */
  a {
      text-decoration: none;
      color: #2980d6;
  }
  a:hover, a:active {
      background-color: #2980d6;
      color: #FFFFFF;
      text-decoration: none;
      text-shadow: 1px 1px 1px #333;
  }
  
  /* Horizontal separators */
  hr {
      color: #A6A6A6;
  }
  
  table {
      width: 100%;
  	border-collapse:collapse;
  	border-spacing:0;
  	display:table
  }
  
  table.minimalistBlack {
    border: 3px solid #000000;
    width: 100%;
    text-align: left;
    border-collapse: collapse;
  }
  table.minimalistBlack td, table.minimalistBlack th {
    padding: 5px 4px;
  }
  table.minimalistBlack tbody td {
    font-size: 15px;
  }
  table.minimalistBlack thead {
    background: #CFCFCF;
    background: -moz-linear-gradient(top, #dbdbdb 0%, #d3d3d3 66%, #CFCFCF 100%);
    background: -webkit-linear-gradient(top, #dbdbdb 0%, #d3d3d3 66%, #CFCFCF 100%);
    background: linear-gradient(to bottom, #dbdbdb 0%, #d3d3d3 66%, #CFCFCF 100%);
    border-bottom: 3px solid #000000;
  }
  table.minimalistBlack thead th {
    font-size: 15px;
    font-weight: bold;
    color: #000000;
    text-align: left;
  }
  table.minimalistBlack tfoot {
    font-size: 14px;
    font-weight: bold;
    color: #000000;
    border-top: 3px solid #000000;
  }
  table.minimalistBlack tfoot td {
    font-size: 14px;
  }
  
  /* Make div for blank space for answers in between questions 
   * Include your own necessary amount of blank space in the 
   * height variable.*/
  .answer_div {
      width:100%;
      height:2in;
      float:left;
  }
  
  /* Define page breaks in document for printing purposes
   * Include the following line
   * <div class="pagebreak"> </div>
   * in order to initiate page breaks for document printing */
  @media print {
      .pagebreak { 
      page-break-before: always; 
      padding-top:1in;
  } 
  }
  
  div.solutions * {
      color:#000099;
  }
  
  </style>
</head>
<body>
<h1 id="homework-2">Homework 2</h1>
<p>STAT 757 – Section 1001 <br> Instructor: Colin Grudzien</p>
<h2 id="due-09132019">Due: 09/13/2019</h2>
<h2 id="instructions">Instructions</h2>
<blockquote>
You may work with others on these problems but you must turn in your own work.<br />
You may type your solutions in any way you like (LaTeX, Markdown, Office, etc…) as long as you present your work clearly and in an organized way.<br> <strong>Whenever plotting:</strong>
<ul>
<li>
Include a copy of a short R script corresponding to your plot.
</li>
<li>
Your plot must be clearly labeled in all axes, legends, and the plot must include a clear title.
</li>
<li>
The plot must be sensible and easy to read.
</li>
</ul>
</blockquote>
<h2 id="problems">Problems</h2>
<h3 id="problem-1">Problem 1:</h3>
<h4 id="prove-each-of-the-following-statements">Prove each of the following statements:</h4>
<ol>
<li>
The sum of the residuals, weighted by the corresponding predictor variable, is zero, <span class="math display">\[\sum_{i=1}^n X_i \hat{\epsilon}_i = 0\]</span>
</li>
<li>
The sum of the residuals, weighted by the corresponding fitted value, is zero, <span class="math display">\[\sum_{i=1}^n \hat{Y}_i \hat{\epsilon}_i = 0\]</span>
</li>
<div class="pagebreak">

</div>
<li>
The estimated regression function always passes through the point defined by the means (or the center of mass), <span class="math inline">\(\left(\overline{X},\overline{Y}\right)\)</span>.
</li>
</ol>
<h4 id="hint-use-the-normal-equations-and-the-point-estimates-of-hatbeta_0hatbeta_1-discussed-in-lecture.">Hint: use the normal equations and the point estimates of <span class="math inline">\(\hat{\beta}_0,\hat{\beta}_1\)</span> discussed in lecture.</h4>
<div class="solutions">
<h4 id="solution">Solution:</h4>
<p>There are many good solutions to this problem and this one is not the only one you may use. However, this will highlight some of the properties that one should remember about these quantities.</p>
<p>Let us begin by recalling the normal equation, <span class="math display">\[\sum_{i=1}^n X_i Y_i = \sum_{i=1}^n \left(\hat{\beta}_0 X_i + \hat{\beta}_1 X_i^2\right).\]</span></p>
<p>Using the above fact, we will examine the equation, <span class="math display">\[\begin{align}
\sum_{i=1}^n X_i \hat{\epsilon}_i &amp;= \sum_{i=1}^n X_i \left( Y_i - \hat{Y}_i \right) \\
&amp; = \sum_{i=1}^n X_i Y_i - X_i \left(\hat{\beta}_0 + \hat{\beta}_1 X_i\right) \\
&amp; = \sum_{i=1}^n X_i Y_i - \sum_{i=1}^n \left(\hat{\beta}_0 X_i \hat{\beta}_1 X_i^2\right) \\
&amp; =0
\end{align}\]</span> by the above relationship.</p>
<p>Now, we will use the above relationship in the following, as well as one other relationship we showed in class, <span class="math display">\[\sum_{i=1}^n \hat{\epsilon}_i = 0.\]</span></p>
<p>Consider, <span class="math display">\[\begin{align}
\sum_{i=1}^n \hat{Y}_i \hat{\epsilon}_i = &amp; \sum_{i=1}^n \left(\hat{\beta}_0 + \hat{\beta}_1 X_i \right) \hat{\epsilon}_i \\
&amp; = \hat{\beta}_0 \sum_{i=1}^n \hat{\epsilon}_i + \sum_{i=1}^n X_i \hat{\epsilon}_i \\
&amp;= 0 + 0,
\end{align}\]</span> by the above properties.</p>
<p>Finally, we will consider that, <span class="math display">\[Y_i = \hat{Y}_i + \hat{\epsilon}_i, \]</span> such that, <span class="math display">\[\sum_{i=1}^n Y_i = \sum_{i=1}^n \hat{Y}_i.\]</span> If we divide both sides by <span class="math inline">\(n\)</span>, the number of cases, we obtain, <span class="math display">\[\overline{Y} = \frac{1}{n}\sum_{i=1}^n \hat{Y}_i .\]</span></p>
<p>But note that, <span class="math display">\[\begin{align}
\frac{1}{n}\sum_{i=1}^n \hat{Y}_i &amp;= \frac{1}{n}\sum_{i=1}^n \left(\hat{\beta}_0 + \hat{\beta}_1 X_i \right) \\
&amp; = \hat{\beta}_0 + \hat{\beta}_1 \overline{X} \\
&amp; = \hat{Y}, 
\end{align}\]</span> i.e, the fitted value for the mean of the predictors <span class="math inline">\(\overline{X}\)</span> is given precisely by the mean of the observed responses. Therefore, the estimated regression function passes through the center of mass.</p>
</div>
<h3 id="problem-2">Problem 2:</h3>
<h4 id="install-the-library-faraway-in-the-r-environment.-then-proceed-to-analyze-the-following-data-sets-in-this-library">Install the library “Faraway” in the R environment. Then proceed to analyze the following data sets in this library:</h4>
<ol>
<li>
The dataset <code>teengamb</code> concerns a study of teenage gambling in Britain. Make a numerical and graphical summary of the data, commenting on any features that you find interesting. Limit the output you present to a quantity that a busy reader would find sufficient to get a basic understanding of the data.
</li>
<li>
The dataset <code>uswages</code> is drawn as a sample from the Current Population Survey in 1988. Make a numerical and graphical summary of the data as in the previous question.
</li>
</ol>
<div class="solutions">
<h4 id="solutions">Solutions:</h4>
<p>Problem 2 will recieve full credit for completion as long as the solution satisfied the instructions. The following are suggested ways to consider these problems, and some techniques that can help with data analysis.</p>
<pre class="{r}"><code>library(faraway)
library(ggplot2)</code></pre>
<h5 id="problem-2.1">Problem 2.1</h5>
<p>We will plot the relationship between weekly income and gambling expenditures, but separate out the values by the reported sex. To do this, we should convert the “sex” column into a factor vector with levels associated to the labels “Male” and “Female”, which are coded as integers in the data. We use the package “plyr” to use the function “revalue” for this purpose.</p>
<pre class="{r}"><code>library(plyr)
tg_sex &lt;- as.factor(teengamb$sex)
tg_sex &lt;- revalue(tg_sex, c(&quot;0&quot;=&quot;Male&quot;, &quot;1&quot;=&quot;Female&quot;))
teengamb$sex &lt;- tg_sex
ggplot(data=teengamb, aes(x=income, y=gamble, color=sex)) + geom_point() + geom_smooth(method=&#39;lm&#39;) + facet_wrap(~ sex) +
  labs(
    x=&quot;Income - pounds per week&quot;,
    y=&quot;Gambling expenditure - pounds per year&quot;,
    title=&quot;Teen gambling expenditures in the UK&quot;,
    color=&quot;Sex&quot;
  )</code></pre>
<p>We note that when we separate out the reported sex, there is a trend between increasing income and increasing gambling expenditures for men. However, for women the relationship between wages and gambling expenditure is basically flat.</p>
<h5 id="problem-2.2">Problem 2.2</h5>
<p>As another example of changing data types, we will plot the income versus years of experience, separated out over the reported race “Black” or “White”, and over the regions of surveyed individuals. To do this, we construct a new vector called “region” from each of the existing columns “ne”, “mw”, “so” and “pt”. Each category is mutually exclusive, and is reported for each observation as 1 (if in this region) or 0 (if not in this region). Therefore, we can rename these values between 1 and 4 and put these entries into a single vector as in the code below.</p>
<pre class="{r}"><code>usw_race &lt;- as.factor(uswages$race)
usw_race&lt;- revalue(usw_race, c(&quot;0&quot;=&quot;White&quot;, &quot;1&quot;=&quot;Black&quot;))
uswages$race &lt;- usw_race
region &lt;- uswages$ne + uswages$mw*2 + uswages$so*3 + uswages$we*4
region &lt;- as.factor(region)
region &lt;- revalue(region, c(&quot;1&quot;=&quot;North East&quot;, &quot;2&quot;=&quot;Midwest&quot;, &quot;3&quot;=&quot;South&quot;, &quot;4&quot;=&quot;West&quot;))
uswages$region &lt;- region
ggplot(data=uswages, aes(x=educ, y=wage, color=race)) + geom_point() + geom_smooth(method=&#39;lm&#39;) + facet_wrap(~ region) +
  labs(
    x=&quot;Education - years&quot;,
    y=&quot;Real weekly wages in USD&quot;,
    title=&quot;Weekly US wages versus education - 1988&quot;,
    color=&quot;Race&quot;
  )</code></pre>
<p>Firstly we see that for individuals reported as “White”, there is a slight trend between increasing education and increasing income. This isn’t uniformly the case, and this trend is expressed in part with an increasing range of income values with years of eduction. However, for individuals reported as “Black”, the trend between years of education and income is largely flat with a much smaller range of values for income in general. We note that regionally, there ins’t significant variation in the trends aside from the differences in reported years of education.</p>
</div>
</body>
</html>
